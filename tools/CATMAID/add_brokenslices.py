import psycopg2


conn_catmaid_settings = {"database": "catmaid",
                         "user": "YOURUSERNAME",
                         "password": "YOURPASSWORD",
                         "host": "YOURSERVER",
                         "port": 5432}
conn = psycopg2.connect(**conn_catmaid_settings)
curs = conn.cursor()

stacktitles = ["'stack_1_name'",
               "'stack_2_name'"]


def stackid_from_title(title):
    stack_id = ("SELECT id FROM stack WHERE title={a};")
    return stack_id.format(a=str(title))

broken_slices = ["00283", "00666", "00710", "00736", "00738", "00778", "00806",
                 "00861", "00863", "00882", "00901", "00911", "00921", "00942",
                 "00946", "00974", "00983", "00998", "01000", "01036", "01038",
                 "01078", "01289", "01310", "01424", "01426", "01428", "01430",
                 "01450", "01452", "01472", "01476", "01478", "01508", "01510",
                 "01528", "01550", "01552", "01567", "01582", "01593", "01595",
                 "01604", "02055", "02562", "02595", "02606", "02610", "02692",
                 "02719", "02723", "02725", "02757", "02766", "02775", "02777",
                 "02803", "02821", "02823", "02825", "02831", "02835", "02849",
                 "02871", "02878", "02890", "02892", "02894", "02911", "02945",
                 "02947", "02951", "02971", "03040", "03042", "03051", "03055",
                 "03057", "03059", "03061", "03063", "03068", "03070", "03085",
                 "03139", "03152", "03154", "03262", "03277", "03283", "03289",
                 "03302", "03321", "03336", "03340", "03372", "03374", "03422",
                 "03456", "03468", "03470", "03472", "03487", "03496", "03498",
                 "03500", "03525", "03556", "03558", "03579", "03608", "03624",
                 "03628", "03696", "03725", "03759", "03793", "04188", "04348",
                 "04433", "04532", "04538", "04540", "04578", "04613", "04695",
                 "04717", "04719", "04756", "04758", "04769", "04822", "04880",
                 "04962", "04964", "04972", "05001", "05003", "05016", "05037",
                 "05087", "05102", "05108", "05117", "05153", "05155", "05174",
                 "05205", "05210", "05260", "05294", "05296", "05312", "05334",
                 "05336", "05338", "05359", "05361", "05363", "05375", "05377",
                 "05381", "05384", "05386", "05388", "05392", "05394", "05410",
                 "05412", "05468", "05523", "05527", "05548", "05550", "05552",
                 "05573", "05596", "05631", "05636", "05677", "05699", "05716",
                 "05719", "05733", "05776", "05809", "05833", "05913", "06110",
                 "06380", "06562", "06613", "06706", "07889", "07965", "07967",
                 "08012", "08039", "08045", "08241", "08247", "08270", "08277",
                 "08280", "08285", "08310", "08315", "08317", "08337", "08430",
                 "08432", "08473", "08687", "08760", "09060", "09110", "09355",
                 "09377", "09388", "09408", "09413", "09423", "09431", "09495",
                 "09502", "09519", "09592", "09605", "09619", "09634", "09644",
                 "09679", "09699", "09780", "09794", "09907", "10040", "10128",
                 "10359", "11370", "11494", "12539", "12934", "17888"]

for stacktitle in stacktitles:
    curs.execute(stackid_from_title(stacktitle))
    StackID = curs.fetchone()[0]
    for item in broken_slices:
        query = ("INSERT INTO broken_slice (stack_id, index) SELECT {a}, {b} "
                 "WHERE NOT EXISTS (SELECT id FROM broken_slice "
                 "WHERE stack_id = {a} AND index = {b});")
        curs.execute(query.format(a=str(StackID), b=str(item)))
conn.commit()
conn.close()
